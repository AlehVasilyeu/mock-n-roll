#!/usr/bin/env node
const program = require('commander');
const path = require('path');
const MocknRoll = require('../index').server;

program
  .description('mock-n-roll')
  .option('-c, --config [path]', 'configuration file for mock-n-roll')
  .parse(process.argv);

const configPath = program.config || path.join(process.cwd(), '/mock-n-roll.conf.js');
const config = require(configPath);

MocknRoll(config)
  .then(() => {
    console.log('Mock-n-Roll started...');
    console.log(`HTTP  : ${config.httpPort}`);
    console.log(`HTTPS : ${config.httpsPort}`);
    console.log(`Target: ${config.target}`);
    console.log(`Prefix: ${config.prefix ? config.prefix : '[none]'}`);
  })
  .catch((err) => {
    console.error(err.stack);
  });
